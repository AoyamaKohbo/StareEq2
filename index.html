<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">

<html lang="ja">

  <head>
    <script type="text/x-mathjax-config">

       MathJax.Hub.Config({TeX:{equationNumbers:{autoNumber:"AMS"}}});

    </script>

    <script type="text/javascript" async 

        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML">

    </script>

  </head>

  <body>
    <h3>多変数の離散型状態空間表現の導出</h3>

    <p>ここでは具体的に連立微分方程式を下記のように記述します。</p>
    \begin{align}
    \left\{
    \begin{array}{@{\,}cc}
    \ddot x_1 + a_{11}x_1 + a_{12}x_2(k)&=~u_1\\
    \ddot x_2 + a_{11}x_1 + a_{12}x_2(k)&=~u_2
    \end{array}
    \right. \label{eq:DffEqn1}
    \end{align}

    <p>式\eqref{eq:DffEqn1}を次式のように書き換えます。</p>
    \begin{align}
    \left\{
    \begin{array}{@{\,}cc}
    \dot x_1 =&~ \dot x_1\\
    \dot x_2 =&~ \dot x_2\\
    \ddot x_1 =&~ - a_{11}x_1 - a_{12}x_2(k) + u_1\\
    \ddot x_2 =&~ - a_{11}x_1 - a_{12}x_2(k) + u_2
    \end{array}
    \right. \label{eq:DffEqn2}
    \end{align}

    <p>ここで、行列とベクトルを次式のように定義します。</p>
    \begin{align}
    \mathbf{x}_1=\left[
    \begin{array}{@{\,}l}
    x_{1}\\
    x_{2}
    \end{array}
    \right],~~
    \mathbf{x}_2=\left[
    \begin{array}{@{\,}l}
    \dot{x}_{1}\\
    \dot{x}_{2}
    \end{array}
    \right],~~
    \mathbf{u}=\left[
    \begin{array}{@{\,}l}
    u_{1}\\
    u_{2}
    \end{array}
    \right],~~
    \mathbf{A}_1=\left[
    \begin{array}{@{\,}cc}
    a_{11}&a_{12}\\
    a_{21}&a_{22}
    \end{array}
    \right]. \label{eq:MatVec}
    \end{align}

    <p>式\eqref{eq:MatVec}の行列とベクトルを用いて式\eqref{eq:DffEqn2}を次式のように表現します。</p>
    \begin{align}
    \left[
    \begin{array}{@{\,}l}
    \dot{\mathbf{x}}_{1}\\
    \dot{\mathbf{x}}_{2}
    \end{array}
    \right]=
    \left[
    \begin{array}{@{\,}cc}
    \mathbf{O}&\mathbf{I}\\
    -\mathbf{A}_1&\mathbf{O}
    \end{array}
    \right]
    \left[
    \begin{array}{@{\,}l}
    \mathbf{x}_{1}\\
    \mathbf{x}_{2}
    \end{array}
    \right]+
    \left[
    \begin{array}{@{\,}l}
    \mathbf{O}\\
    \mathbf{I}
    \end{array}
    \right]
     \mathbf{u}
    \end{align}

    <p>さらに行列\(\mathbf{A}\)、\(\mathbf{B}\)とベクトル\(\mathbf{x}\)を次式のように定義します。</p>
    \begin{align}
    \mathbf{x}=\left[
    \begin{array}{@{\,}l}
    \mathbf{x}_{1}\\
    \mathbf{x}_{2}
    \end{array}
    \right],~~
    \mathbf{A}=\left[
    \begin{array}{@{\,}cc}
    \mathbf{O}&\mathbf{I}\\
    -\mathbf{A}_1&\mathbf{O}
    \end{array}
    \right],~~
    \mathbf{B}=\left[
    \begin{array}{@{\,}l}
    \mathbf{O}\\
    \mathbf{I}
    \end{array}
    \right].
    \end{align}

    <p>連続系の多変数状態空間表現が次式となります。</p>
    \begin{align}
    \dot{\mathbf{x}}=\mathbf{A}\mathbf{x} + \mathbf{B}\mathbf{u}  \label{eq:StateEq}
    \end{align}

    <h3>行列指数関数</h3>
    <p>ここで、行列指数関数\(e^{\mathbf{X}}\)を導入します。</p>
    \begin{align}
    e^{\mathbf{X}} = \sum_{n=0}^{\infty}\frac{1}{n!}\mathbf{X}^n =  \mathbf{I}+\frac{1}{1!}\mathbf{X}+\frac{1}{2!}\mathbf{X}^2++\frac{1}{3!}\mathbf{X}^3+\cdots \label{eq:MatExp}
    \end{align}

    指数関数\(e^{x}\)と同様に次式が成立します。
    \begin{align}
    \frac{de^{\mathbf{X}}}{dt} = \dot{\mathbf{X}}e^{\mathbf{X}} \label{eq:DffMatExp}
    \end{align}

    <h3>離散型状態空間表現</h3>
    <p>式\eqref{eq:StateEq}に\(\mathbf{x}=e^{\mathbf{A}t}\mathbf{c}\)を代入すると次式が得られます。</p>
    \begin{align}
    e^{\mathbf{A}t}\dot{\mathbf{c}} = \mathbf{B}\mathbf{u} \label{eq:VecEq1}
    \end{align}    

    <p>式\eqref{eq:VecEq1}の両辺に左側から\(e^{-\mathbf{A}t}\)を乗じて積分すると次式になります。</p>
    \begin{align}
    \mathbf{c}(t) = \int_0^t e^{-\mathbf{A}t}\mathbf{u}d\tau + \mathbf{d} \label{eq:SysEqn3}
    \end{align}
    <p>ここに、\(\mathbf{d}\)は定数ベクトルです。</p>

    <p>式\eqref{eq:SysEqn3}の\(\mathbf{c}\)を\(\mathbf{x}=\mathbf{c}e^{\mathbf{A}t}\)に代入すると\(\mathbf{x}\)は次式となります。</p>
    \begin{align}
    \mathbf{x}(t)=\mathbf{d}e^{\mathbf{A}t} + \int_0^t e^{\mathbf{A}(\tau-T)}\mathbf{u}d\tau \label{eq:SysEqn4}
    \end{align}

    <p>\(t=0\)のとき\(\mathbf{x}=\mathbf{d}=\mathbf{x}(0)\)となるので、式\eqref{eq:SysEqn4}は次式となります。</p>
    \begin{align}
    \mathbf{x}(t)=e^{\mathbf{A}t}\mathbf{x}(0) + \int_0^t e^{\mathbf{A}(\tau-T)}\mathbf{u}d\tau \label{eq:SysEqn5}
    \end{align}

    <p>\(t=T\)のとき\(\mathbf{x}=\mathbf{x}(T)\)とすれば式\eqref{eq:SysEqn5}から次の漸化式が得られます。</p>
    \begin{align}
    \mathbf{x}(T)=e^{\mathbf{A}T}\mathbf{x}(0) + \int_0^T e^{\mathbf{A}(\tau-T)}\mathbf{u}d\tau \label{eq:SysEqn6}
    \end{align}

    <p>式\eqref{eq:SysEqn6}の時間区間[0,T]では\(\mathbf{u}(t)=\mathbf{u}(0)\)とすると次式になります。</p>
    \begin{align}
    \mathbf{x}(T)=e^{\mathbf{A}T}\mathbf{x}(0) + \{\int_0^T e^{\mathbf{A}(\tau-T)d\tau}\}\mathbf{u}(0) \label{eq:SysEqn7}
    \end{align}

    <p>
      式\eqref{eq:SysEqn7}は\(x(0)\)を初期値として\(T\)秒後の\(x(T)\)の計算式となっています。
      したがって、初期値\(x(nT)\)に対する\(T\)秒後の\(x((n+1)T)\)は次式となります。
    </p>
    \begin{align}
    \mathbf{x}((n+1)T)=e^{\mathbf{A}T}\mathbf{x}(nT) + \{\int_0^T e^{\mathbf{A}(\tau-T)d\tau}\}\mathbf{u}(nT) \label{eq:SysEqn8}
    \end{align}

    <p>
      ここで、\(\mathbf{x}(nT)\)を\(\mathbf{x}(n)\)、\(\mathbf{u}(nT)\)を\(\mathbf{u}(n)\)と表記し、\(\mathbf{A}=e^{-\mathbf{A}T}\)、\(\mathbf{B}=\int_0^T e^{\mathbf{A}(\tau - T)}d\tau\)
      とおくと、次の多変数の離散型状態空間表現が得られます。
    </p>
    \begin{align}
    \mathbf{x}(n+1)=\mathbf{A}\mathbf{x}(n) + \mathbf{B}\mathbf{u}(n) \label{eq:SysEqn9}
    \end{align}


   <p><a href="https://aoyamakohbo.github.io/Craftlogy/">->TOP</a></p>
</body>

</html>
